🎯 راه‌اندازی خودکار تونل GRE6 با IPv6 + 6to4 (اسکریپت خودبه‌روزرسان)
📌 معرفی

این اسکریپت برای برقراری تونل ارتباطی بین دو سرور (مثلاً یک سرور در ایران و یک سرور در خارج) طراحی شده است. تونل از طریق IPv6 (نوع GRE6) و 6to4 ساخته می‌شود و در صورت موفقیت، امکان عبور ترافیک با NAT فراهم می‌شود.
🛠 نصب اولیه

برای نصب اولیه اسکریپت، تنها کافی‌ست دستور زیر را در سرور ایران وارد کنید:

bash <(curl -Ls https://raw.githubusercontent.com/hamedjafari-ir/gre-tunnel-setup/main/setup-tunnel.sh)

با این دستور، اسکریپت به‌طور خودکار در مسیر /usr/local/bin/tunnel نصب می‌شود و از آن پس می‌توانید فقط با تایپ دستور زیر اسکریپت را اجرا کنید:

tunnel

📋 منوی اصلی و توضیح هر گزینه

پس از اجرای دستور tunnel، یک منوی تعاملی ظاهر می‌شود:
1️⃣ Auto Setup Tunnel

نصب خودکار تونل بین دو سرور. اطلاعات زیر از شما گرفته می‌شود:

    آدرس IP سرور خارجی

    آدرس IP سرور داخلی (ایران)

    یوزرنیم SSH سرور خارجی

    پسورد SSH

اسکریپت به‌ترتیب:

    اتصال SSH به سرور خارجی را چک می‌کند.

    تنظیمات 6to4 را در هر دو سرور انجام می‌دهد.

    ارتباط IPv6 را تست می‌کند.

    تونل GRE6 را تنظیم می‌کند.

    پینگ داخلی و خارجی را چک می‌کند.

    NAT و Forwarding را فعال می‌کند.

در پایان اگر موفقیت‌آمیز باشد، وضعیت CONNECTED در منو نمایش داده می‌شود.
2️⃣ Manual Setup

در این حالت مراحل را باید به صورت دستی در هر سرور اجرا کنید. فقط مناسب کاربران حرفه‌ای است.
3️⃣ Test Ping

تست اتصال از ایران به خارج یا بالعکس از طریق آدرس‌های IPv6 و آدرس‌های داخلی GRE:

    انتخاب از منو:

        از ایران به خارج (fde8::de01 → de02 / 172.20.20.1 → 172.20.20.2)

        از خارج به ایران (برعکس)

4️⃣ Restart Server

دستور ریستارت سرور را صادر می‌کند. توجه کنید پس از انتخاب، ۵ ثانیه فرصت دارید.
5️⃣ About This Script

توضیحات درباره نویسنده، لایسنس و هدف کلی اسکریپت.
6️⃣ Check GRE Tunnel Status

بررسی می‌کند که آیا تونل GRE برقرار شده یا نه:

    اگر برقرار باشد و ping موفق باشد، پیام موفقیت نشان می‌دهد.

    در غیر این صورت، هشدار می‌دهد که تونل فعال نیست یا ping انجام نشده.

7️⃣ Check Target IP Reachability

این گزینه به شما امکان می‌دهد یک IP مقصد وارد کنید (مثلاً IP سرور خارجی دیگر). اسکریپت چک می‌کند که آیا این IP از سرور فعلی قابل دسترسی هست یا خیر.
کاربرد: بررسی فیلتر بودن یا قطع بودن سرور خارجی.
8️⃣ Exit

خروج از منوی اصلی.
✅ نیازمندی‌ها

در اولین اجرا، اسکریپت به‌طور خودکار ابزارهای موردنیاز را نصب می‌کند:

    curl

    ip

    ssh, sshpass

    ping, ping6

    iptables

📦 ویژگی‌ها

    نصب خودکار و سریع

    به‌روزرسانی خودکار از GitHub

    تست اتصال کامل

    NAT و IP Forwarding خودکار

    تشخیص اتصال موفق در منو

    بررسی فیلترینگ یا مسدود بودن سرور خارجی

در صورتی که نیاز به پشتیبانی یا توسعه بیشتر داشتید، لطفاً در بخش Issues یا Discussions همین مخزن با من در میان بگذارید.
